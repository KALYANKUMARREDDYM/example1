<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="dbdf1aa3-9c93-4e05-9a7e-ed231d923c89" activeEnvironment="Default" name="MINDTREE EMPLOYEE API" resourceRoot="${projectDir}" soapui-version="5.5.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="bc9faa4f-30f4-47fb-a317-b182c81e9a69" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="Employee" path="/api/v1/employee" id="65c1e3b4-918b-4b4e-be52-08b77ba0887f"><con:settings/><con:parameters/><con:method name="Employee 1" id="652077f1-776e-479e-9d34-8d986842dc55" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>201</con:status><con:params/><con:element xmlns:emp="https://mindtree-emp.azurewebsites.net/api/v1/employee">emp:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500 400</con:status><con:params/><con:element xmlns:emp="https://mindtree-emp.azurewebsites.net/api/v1/employee">emp:Fault</con:element></con:representation><con:request name="POST" id="dc2ec774-9bc7-4c09-8cb7-24980f490a80" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "CSE",
  "id": 88,
  "name": "Kalyan",
  "yearOfJoining": 2021
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employee</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="6d64bc36-1e12-4969-ba2c-02809dc55bfd" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="Employees" path="/api/v1/employees/${#TestSuite#id}" id="42ae72be-f52e-4c86-9f97-f436b60a24f5"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value/><con:style>TEMPLATE</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="Employees 1" id="1d5cc3c2-91f0-4de4-be65-92490c201ef5" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>202</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/1000">ns:Response</con:element></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/1000">ns:Fault</con:element></con:representation><con:request name="GET" id="33b1a5d5-1286-426d-b738-8d4801a16fae" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/1000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="88" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="6b674da2-825f-4eb5-ba3a-52f3db821731" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="5" path="/api/v1/employees/{id}" id="2c71835b-f157-4ab2-a9be-d9547b12fd11"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value/><con:style>TEMPLATE</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="5 1" id="7e451c74-db90-4756-8fef-7dc5b5b20458" method="PUT"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>202</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/5">ns:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500 405</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/5">ns:Fault</con:element></con:representation><con:request name="PUT" id="2c5ad719-0cae-4c9d-a30e-aeef9ac36f37" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "mindtree",
  "name": "kumar",
  "yearOfJoining":2022
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/5</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="88" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="e4a43dd7-28bc-4a1f-a99c-9872a6f67328" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="1000" path="/api/v1/employees/{id}" id="4af51188-7331-4de4-8f35-1179312b5594"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value/><con:style>TEMPLATE</con:style><con:default/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="1000 1" id="4a9ec43a-c9bf-4b48-aaba-8b9c522d2a0f" method="DELETE"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>500 410 405</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/10001000">ns:Fault</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="DELETE" id="7da945dd-3d38-482f-b33d-a97cfe2d19ef" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/1000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="88" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="25ab21fd-f29c-442c-b1fc-cfe5206c6bac" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://mindtree-emp.azurewebsites.net" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint></con:endpoints><con:resource name="1" path="/api/v1/employees/{id}" id="d0f9c73d-718e-41c3-93a3-39bef14fe64a"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:style>TEMPLATE</con:style></con:parameter></con:parameters><con:method name="1 1" id="503c2838-d848-434b-ade0-c570dbe0172a" method="DELETE"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>410 500</con:status><con:params/><con:element xmlns:ns="https://mindtree-emp.azurewebsites.net/api/v1/employees/11">ns:Fault</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="Request 1" id="148d68aa-d594-4457-b093-cf19cd536e27" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/11</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="11" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite id="70636eeb-b60f-403e-a55d-07c32ba76e4d" name="TestSuite 1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="1d51d163-014b-4914-915a-6f242ca58740" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="POST Request" id="b4506a94-b5d9-4823-8d4a-2306642b3efb"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employee" methodName="Employee 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="POST Request" id="dc2ec774-9bc7-4c09-8cb7-24980f490a80" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "${#TestSuite#compitency}",
  "id": "${#TestSuite#id}",
  "name": "${#TestSuite#name}",
  "yearOfJoining": "${#TestSuite#yearOfJoining}"
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employee</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="GET Request" id="5db17d03-837f-43ac-9b7b-523254ebffb2"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employees/${#TestSuite#id}" methodName="Employees 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GET Request" id="33b1a5d5-1286-426d-b738-8d4801a16fae" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/1000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${#TestSuite#id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="PUT Request" id="08b6d07e-71bf-411c-b39f-98311c3ce437"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employees/{id}" methodName="5 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="PUT Request" id="2c5ad719-0cae-4c9d-a30e-aeef9ac36f37" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request>{
  "compitency": "${#TestSuite#compitency}",
  "name": "${#TestSuite#name}",
  "yearOfJoining": "${#TestSuite#yearOfJoining}"
}</con:request><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/5</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${#TestSuite#id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="DELETE Request" id="4a9e97cc-0732-4594-a510-08223a8f3546"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employees/{id}" methodName="1000 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="DELETE Request" id="7da945dd-3d38-482f-b33d-a97cfe2d19ef" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/10001000</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${#TestSuite#id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="21c6b9d4-2727-4508-bf1e-393e79c0788e"><con:settings/><con:config><script><![CDATA[import jxl.*
import jxl.write.*
import groovy.json.JsonSlurper



//Excel Data For POS
Workbook work = Workbook.getWorkbook(new File("C://Users//M1080609//Desktop//EmployeeData.xls"));
Sheet data = work.getSheet(0)
String compitency = data.getCell(0,1).getContents()
String id = data.getCell(1,1).getContents()
String name = data.getCell(2,1).getContents()
String yearOfJoining = data.getCell(3,1).getContents()

//post request starts
testRunner.testCase.testSuite.setPropertyValue("compitency",compitency)
testRunner.testCase.testSuite.setPropertyValue("id",id)
testRunner.testCase.testSuite.setPropertyValue("name",name)
testRunner.testCase.testSuite.setPropertyValue("yearOfJoining",yearOfJoining)
def postrequest = testRunner.testCase.testSuite.testCases["TestCase 1"].testSteps["POST Request"]

log.info "one"
log.info postrequest
log.info"Running POST Request"
def rest=postrequest.run(testRunner,context)
def jresponse1 =postrequest.testRequest.response.responseContent
JsonSlurper slurper = new JsonSlurper()
def parsedJson = slurper.parseText(jresponse1)

if(parsedJson.httpStatus.equals("CREATED")){
log.info"POST Request got executed and details are added successfully"
assert true
}else{
log.info"POST Request got failed and unsuccessful"
assert false
}



//Get
testRunner.testCase.testSuite.setPropertyValue("id",id)
def getrequest = testRunner.testCase.testSuite.testCases["TestCase 1"].testSteps["GET Request"]
log.info"Running GET Request"
def rest1=getrequest.run(testRunner,context)
def jresponse2 =getrequest.testRequest.response.responseContent
def parsedresponse1 = slurper.parseText(jresponse2)
log.info(jresponse2)
if(parsedresponse1.httpStatus.equals("ACCEPTED")){
log.info"GET Request has run successfully"
assert true
}
if(parsedresponse1.body.name.equals(name) && parsedresponse1.body.compitency.equals(compitency) && parsedresponse1.body.yearOfJoining.equals(yearOfJoining.toInteger())){
log.info"Details of the employee are present"
assert true
}else{
log.info"Employee Details are not present"
assert false
}
//Excel Data For PUT
compitancy = data.getCell(0,2).getContents()
id = data.getCell(1,2).getContents()
name = data.getCell(2,2).getContents()
yearOfJoining = data.getCell(3,2).getContents()



//Put
testRunner.testCase.testSuite.setPropertyValue("compitency",compitency)
testRunner.testCase.testSuite.setPropertyValue("id",id)
testRunner.testCase.testSuite.setPropertyValue("name",name)
testRunner.testCase.testSuite.setPropertyValue("yearOfJoining",yearOfJoining)
log.info"Running PUT Request Updating the values"
def getIdTestStep2 = testRunner.testCase.testSuite.testCases["TestCase 1"].testSteps["PUT Request"]
def rest2=getIdTestStep2.run(testRunner,context)
def jresponse3 =getIdTestStep2.testRequest.response.responseContent
def parsedresponse2 = slurper.parseText(jresponse3)
if(parsedresponse2.httpStatus.equals("UPDATED")){
log.info"Employee details are updated successfuly and put request got successfull"
assert true
}else{
log.info"Employee details not updated successfuly and put request got failed"
assert false
}



//Get
testRunner.testCase.testSuite.setPropertyValue("id",id)
def getIdTestStep3 = testRunner.testCase.testSuite.testCases["TestCase 1"].testSteps["GET Request"]
def rest3=getIdTestStep3.run(testRunner,context)
def jresponse4 =getIdTestStep3.testRequest.response.responseContent
def parsedresponse3 = slurper.parseText(jresponse4)
if(parsedresponse3.httpStatus.equals("ACCEPTED")){
log.info"GET Request was successfully"
assert true
}
if(parsedresponse3.body.name.equals(name) && parsedresponse3.body.compitency.equals(compitency) && parsedresponse3.body.yearOfJoining.equals(yearOfJoining.toInteger())){
log.info"Employee details was Updated"
assert true
}else{
log.info"Employee details was not Updated"
assert false
}



//Delete
testRunner.testCase.testSuite.setPropertyValue("id",id)
def getIdTestStep4 = testRunner.testCase.testSuite.testCases["TestCase 1"].testSteps["DELETE Request"]
log.info"Running DELETE Request"
def rest4=getIdTestStep4.run(testRunner,context)
def jresponse5 =getIdTestStep4.testRequest.response.responseContent
def parsedresponse4 = slurper.parseText(jresponse5)
if(parsedresponse4.httpStatus.equals("DELETED")){
log.info"Empoyee Details has been deleted  and request passed"
assert true
}else{
log.info"Empoyee Details not deleted and  unsuccessful"
assert false
}

work.close()]]></script></con:config></con:testStep><con:testStep type="restrequest" name="deletee" id="308a7d8a-cb1c-4538-9083-6f75be2fd0a6"><con:settings/><con:config service="https://mindtree-emp.azurewebsites.net" resourcePath="/api/v1/employees/{id}" methodName="1 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="deletee" id="148d68aa-d594-4457-b093-cf19cd536e27" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://mindtree-emp.azurewebsites.net</con:endpoint><con:request/><con:originalUri>https://mindtree-emp.azurewebsites.net/api/v1/employees/11</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${#TestSuite#id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:properties><con:property><con:name>compitency</con:name><con:value>IT</con:value></con:property><con:property><con:name>id</con:name><con:value>608</con:value></con:property><con:property><con:name>name</con:name><con:value>Kalyan </con:value></con:property><con:property><con:name>yearOfJoining</con:name><con:value>2000</con:value></con:property></con:properties></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/></con:soapui-project>